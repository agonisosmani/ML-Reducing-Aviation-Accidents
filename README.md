# Reducing-Commercial-Aviation-Fatalities1.	Introduction
1.1	AI in Aviation

Artificial Intelligence development is growing rapidly and is having a great impact nowadays in every sector of life. Artificial intelligence systems are integrated everyday in every device that we use. From these rapid changes in the development of this technology, the impact is evident also in aviation such as commercial aviation or military. Machine learning models today are applied in many sectors of aviation such as aircraft design and operations, manufacturing, maintenance, management of air traffic controlling (ATC), etc. In the meantime, one of the fields of aviation where AI is necessary today is managing risk and aviation safety. AI with the help of machine learning models, has the potential to offer solutions to many problems in aviation safety through risk identification, classification of dangerous phenomena, design of risk portfolios and prioritizing of risk cases. The need for avoiding dangerous situations is very high and this can help in reducing commercial aviation fatalities. In the following research, we will introduce the methods and opportunities for predicting these risk factors through the appliance of machine learning models. On the other hand, understanding data and hidden patterns may provide great solutions. 


2.	Problem Statement

The business problem that we are treating presents these questions: 
•	Can we predict the cognitive states of pilots by measuring their psychophysiological data?
•	Which data features have the most importance in predicting these cognitive states?
•	Can we raise an alerting state in an aircraft’s cockpit when they are facing dangerous situations during a real flight?
•	Is possible that these alerts help the pilots to take better decisions that can lead to avoiding accidents because of human error?
•	How this prediction would impact the safety of the aviation industry and the financial management of airlines? 
Considering that pilots during their flights are constantly distracted by various factors such as communications from ATC, crew requirements, bad weather conditions, and machinery failures, this may make them lose the so-called Airplane State of Awareness (ASA), which is a very important factor for making errors and bad decisions during the flight. These errors often cause accidents resulting in fatalities. Following this, the research aims to answer these questions by finding methods that can prevent loose of ASA and replace bad decisions with better ones.  
The use of cognitive states with machine learning is an attractive challenge, as it has shown extraordinary improvements in the system's ability to learn in many fields. Some authors who have explored cognitive computing in this research have argued that implementing AI solutions to replace certain pilot operations and responsibilities may require specific methodologies to ensure the proper application of new functionalities. However, this research always considers that AI technology cannot replace the role of healthcare professionals and must be user-friendly to avoid potential frustration among professionals within the pilot's cabin.

2.1	Cognitive States for Aviation Safety

The impact of cognitive prediction in aviation security is mentioned by the Commercial Aviation Safety Team (CAST). One of the improvements is in the safety field of the ASA. Of the 18 aircraft incidents observed, 16 of them were due to a loss of awareness of aircraft control. For this reason, CAST emerges the need for improvements in attention management. In the meantime, a co-research of the Federal Aviation Authority and the University of Illinois stated that approximately 80% of aircraft incidents happen from human errors. 
In another research from Borghini et. (2014), the relationship between physiological and high mental workload, mental fatigue, and satiety is treated. This research is focused on researching the classification of cognitive states. Results achieved explain the possibility of value change in physiological values when they enter cognitive states. The relative contribution of variables in predicting cognitive states is related to EEG values, heartbeat, and eye pupil contraction or dilation. This is related to our first question about the problem statement. The research of Borghini et. (2014) refers to the flight of Turkish Airlines to Amsterdam airport in 2009. During this fatal accident, the airplane crew was not able to notice the cause of the autothrottle system reducing the thrust in engines. In a very short time span, this situation became channelized attention and led the situation to an irreversible fatal state. 
It is difficult to predict which cognitive state notification could improve the situation. It is necessary to mention that finding the cognitive state does not solve the problem. However, being able to pre-predict an unsafe state, means that with alerts and notifications, the flight crew is more focused on addressing the dangerous states and would not neglect serious situations. On our point of view, this can help on preventing incidents and at the same time increase aviation safety.

3.	Methodology and Modeling
3.1	Data Description

The data obtained from Kaggle due to platform policies, we are not allowed to gain the original full data, but they’re already split in a train and test set. Data are cleaned of noise and there are no missing values or null. In this case, the processing of the data is mainly focused on visualizing, finding the possible outliers, removing duplicate records, and dropping variables with a high level of correlation. 
The dataset contains 28 variables and 4.8 million entries. These data are gathered from 18 pilots who describe the pilot's physiological performance through ECG, EEG, GSR, and R sensors. Pilots were subject to many distractions and 4 cognitive states were collected from their psychophysiological performance. These 4 cognitive states are Baseline, Channelized Attention (CA), Diverted Attention (DA), and Startle/Surprise (SS).  
Baseline: The situation where the pilots are not in a specific state after distraction. This is the most observed state from the dataset.
Channelized Attention: This represents focusing on just one particular task to find as much possible information as possible in that task. This can be a dangerous state for pilots because other tasks are necessary to be handled at the same time during the flight operation
Diverted Attention: The situation where the mental state of the pilots is not stable due to distractions of the thinking process and trying to find a solution to take the right decision. 
Startle/Surprise: The state where the pilots were in front of startle situations that can be frightening such as watching a video with spontaneous surprising content. 
Data is split in the feature seat because the data is for 18 pilots in 9 pilot cabins. This means that part of the same experiment is in real-time, both the captain and the first officer. Classification is made for pilots who can be in a safe mental state or dangerous mental state. 
3.2	Data Variables

Data variables included in this dataset are: 
Crew: represents the pilot's identity. 
Time: tells the time of monitoring and evaluating in seconds.
Experiment: represents one of the cognitive states like CA, DA, or SS.
Seat: cockpit seats, where 0 stands for the left seat, and 1 stands for the right seat.
EEG: acronym for electroencephalogram. This sensor has 20 electrodes which are set in different parts of the human brain, to measure impulses from these brain parts. 20 different combinations are made between these electrodes to show the physiological values.
ECG: stands for electrocardiogram which is a sensor that measures the heartbeat using electrodes with electromagnetic waves. 
R: is an indicator that measures respiratory system levels and breathing levels, by measuring the rise and fall of the chest during breathing.
GSR: acronym for galvanic skin response. Measures changes in the behavior of the sweat gland, which indicates the magnitude of the emotional state or emotional arousal of the participants.

3.3	Data Visualization 

From the visualization of the data, we understand that in the events in which the pilots could be found after conducting experiments with higher levels of concentration, the most frequent event is Baseline (A) with 58.5%, while the least or minimal event is SS with only 2.7%. Also, from the data, it can be inferred that seat variable have no weight in the overall results, which means that for both pilots in the cabin, as well as for the captain and the assistant, the experiments had almost identical results.
From the visualization of the data with violin plots of ECG sensors, we understand that some data in different fractions of the dataset are missing. However, the most concentrated ones are in the -10k microvolt to 20k zones, and less concentrated in the 20k to 30k microvolt for event A. For event C, they are concentrated from -10k to 10k, while 25k to 30k are less concentrated. For event D, they are concentrated from -15k to 22k, while less concentrated from -20k to -15k. Event B has a concentration in the 0 to 10k region and less in the 25k to 30k region.
From the observation of GSR for each event, the visualization of the data shows that the graph is very similar to the data from ECG and differs only in the fact that it does not contain negative signals. From the observation of Respiratory, the graph shows a range from 500 to 850 and is very similar for all events. The data presents a lot of noise due to millions of observations every second during measurements with these sensors, but nevertheless, all these variables are essential for the final purpose of the machine learning model, and for this reason, they cannot be eliminated from the dataset. Therefore, in order to improve the performance of the models, feature engineering will be applied.
Feature Engineering: Having into consideration that the data are not complete in the existing form of the dataset, we will use feature engineering to improve the performance of the models. Few features will be added after this process and mainly this is done by using a very powerful Python tool for medicinal sensors like the ones we have in the dataset. This tool is Biosspy. 
Biosppy: Using this tool we are able to extract many features with much more useful information from the ECG sensor such as heart_rate variable. This variable, from visualization, gives a lot of important information in overall the dataset, but especially for event B, where the heart_rate values are the highest. This variable has noise and needs to be cleaned. We use the same tool for deriving new data features from the Respiratory variable, creating resp_rate. For the EEG sensor, the potential difference of electrodes is derived. The biosppy tool separates the gained values based on Hz and 5 new data features are extracted: Theta, Alpha (low and high), Beta, and Gamma. 

Correlation: In this research, correlation is used to dictate which features are less important in model prediction. From the data obtained, seat data feature doesn’t have an impact on the final prediction. For this reason, to reduce the complexity of the dataset, this variable is dropped. In the meantime, from correlation values, it is narrated that features theta and alpha have strong importance. Following this, due to similarity, the variables beta and gamma will also be dropped from the dataset. Another intervention in the dataset is necessary in order to obtain model prediction results without the bias of the previous experiment from the training set. This means that the experiment data feature will also be removed. 

3.4	Modeling 

To predict cognitive states and use that prediction as a tool to alert pilots when they are in a dangerous state while flying, we will use several models. First, we tried this with the Random model, where the accuracy was low and the LogLoss evaluation of this model was very high at 1.645, which was definitely not satisfactory and guided us to try other models.
As the second model, we used Logistic regression. This model showed an accuracy score of 0.60, while the LogLoss was 0.94. This model performed better, but we are still far from satisfactory results.
For this reason, we decided to test a model that performed best in the Kaggle competition and depending on the approach to this model, a higher accuracy could be achieved. Considering that the data has been processed and new variables have been derived, the LightGBM model has achieved a maximum accuracy of 0.94 and the lowest log loss of 0.10. At this point, we can say that we have a satisfactory level of predicting cognitive states, which can serve us further to draw some conclusions, results, and hypotheses about the development of possible solutions to the problem presented by this research.

 


Evaluation Criteria: to evaluate the model’s accuracy we used Log-Loss. Log-Loss is a very powerful metric to evaluate models with classification problems. This metric is used to indicate how close is the prediction to the actual value of one binary classification. If the Log-Loss values are high, this means that the predicted probability differs from the true value, meaning that the model’s performance is not accurate. On the models that we tested, only the LightGBM model’s performance is under 0.20, which was our aim to reach before developing the model. 
4.	Results and Conclusions

From the results found from the model, we can conclude that using a machine learning model, we can predict the mental state of pilots 94% of the time (safe or dangerous). Starting from this point, we are able to give solutions to our problem of reducing commercial aviation fatalities. This can be done in these ways:
Preflight Assessment: Airline companies can develop a program to control the mental cognitive state of pilots before they operate their flight, in order to understand if they are in a stable mental state or if their mental state is safe enough to operate a flight. This is done by using this machine-learning model in real time. 
Early Intervention: If pilots are identified by the model that they are in a dangerous mental state, airlines can provide information and resources to them to orient them on how to proceed in that dangerous state before a major problem that can cause incidents to happen. 
After Incident Analysis: Often in an aviation incident, the conclusions for the accident cause are very hard to be found, even after observing “the black box”. This happens especially when the cause of the accident happens due to human error. Following this, our machine learning model can serve the airlines to quickly find the exact reason for the incident by giving data from the pilot’s mental state. This could be very useful later in correcting mistakes and finding better solutions. 

4.1	Proposed Solution

The present study aims to design a product incorporating sensors for four variables, namely ECG, respiration rate, GSR, and heart rate, which have demonstrated significant importance during model training. To enhance user-friendliness, it is proposed to exclude EEG sensors due to the difficulty in inserting 20 sensors at different locations in the brain during flight, which could potentially affect the pilot negatively. The proposed product would be linked to a server, where data would be transmitted in real-time, and the AI-trained model would provide feedback through a chatbot with a voice synthesizer, alerting the pilot about their condition and offering suggestions on decisions and actions to be taken in the situation. However, given the ambitious nature of the proposal, further research is required to understand the significance of the model in predicting pilot cognitive states and its impact on preventing air accidents.
Figure 2 is one example of an Epoc headset in the market which contains all the necessary sensors to measure psychophysiological data for the pilots. This product, connected to an AI system, may provide real-time data needed for our solution. Applying cognitive computing to pilots gives the opportunity to explore the benefits of providing assistance to pilots in their decision-making process in very fragile situations. This solution may provide the pilots with extra support in operating the flights by managing non-normal situations. 
 

4.2	Discussions 

Due to the fact that the competition created by Kaggle four years ago remains open and without a final solution to this problem, it limits our opportunities to translate the values of the machine learning model into saved human lives, which is the main motivation for this research, secondly, the financial benefit for airline companies from preventing costly accidents and avoiding legal fees. However, we will raise a hypothesis based on some statistics about the value of the machine learning model. Based on statistics from the Human Factors Analysis and Classification System, out of 181 observed air incidents resulting from human error, 77 accidents occurred as a result of unprovoked errors or conditions were not met to add mechanical error, computer reading, or atmospheric problems as the cause of the error. Out of these 77 accidents, most of the reasons that led to unsafe acts as the cause of the accidents were: skill-based errors, decision-based errors, perceptual errors, or violations. This prompted us to investigate how necessary the model we built would be.
Hypothesis: Assuming that by accurately detecting 77 previously unprovoked pilot error incidents, our model would correctly identify 94% of these losses of control events. This means that in 72 accidents, the model would provide an accurate warning that pilots are in an unsafe state during flight. However, since this is an ideal scenario, we will set a threshold that our model would only impact positive outcomes in 80% of the predicted cases. In this case, 56 incidents would have a positive outcome compared to what has occurred. From this hypothesis, we will determine the most observed values of aircraft currently in the market, as well as the number of people they carry in their crew during flights. For our hypothesis, we will take the Airbus A220 model as the most observed. This plane currently costs around 90 million US dollars in the market, and in each reported accident, an average of 50 lives are lost. Based on the constructed hypothesis, our model would save 2,800 lives and 5 billion dollars for airline companies.
